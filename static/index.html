<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ToToogle - Feature Toggle Manager</title>
    <link rel="stylesheet" href="/static/styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Main Layout Container -->
    <div class="app-layout">
        <!-- Header/Navigation -->
        <header class="app-header">
            <div class="header-content">
                <div class="brand-section">
                    <div class="brand-icon">
                        <svg width="32" height="32" viewBox="0 0 32 32" fill="currentColor">
                            <path d="M4 8h6v2H4V8zm0 4h6v2H4v-2zm0 4h6v2H4v-2zm8-8h16v2H12V8zm0 4h16v2H12v-2zm0 4h16v2H12v-2z"/>
                            <rect x="6" y="18" width="20" height="10" rx="2" fill="none" stroke="currentColor" stroke-width="2"/>
                            <circle cx="23" cy="23" r="2" fill="currentColor"/>
                        </svg>
                    </div>
                    <div class="brand-text">
                        <h1 class="brand-title">ToToogle</h1>
                        <p class="brand-subtitle">Feature Toggle Manager</p>
                    </div>
                </div>
                
                <div class="header-actions">
                    <div class="header-status">
                        <span class="status-indicator online">
                            <svg width="8" height="8" viewBox="0 0 8 8" fill="currentColor">
                                <circle cx="4" cy="4" r="4"/>
                            </svg>
                            System Online
                        </span>
                    </div>
                    
                    <!-- User Profile Menu -->
                    <div class="user-menu" id="user-menu">
                        <button class="user-menu-trigger" id="user-menu-trigger">
                            <div class="user-avatar" id="user-avatar">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                                    <circle cx="12" cy="7" r="4"/>
                                </svg>
                            </div>
                            <span class="user-name" id="user-name">Admin</span>
                            <svg class="user-menu-chevron" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="6,9 12,15 18,9"/>
                            </svg>
                        </button>
                        
                        <div class="user-menu-dropdown hidden" id="user-menu-dropdown">
                            <div class="user-menu-header">
                                <div class="user-menu-avatar">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                                        <circle cx="12" cy="7" r="4"/>
                                    </svg>
                                </div>
                                <div class="user-menu-info">
                                    <div class="user-menu-name" id="dropdown-user-name">Admin</div>
                                    <div class="user-menu-role" id="dropdown-user-role">Administrator</div>
                                </div>
                            </div>
                            
                            <div class="user-menu-divider"></div>
                            
                            <div class="user-menu-items">
                                <button class="user-menu-item" onclick="openProfileModal()">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                                        <circle cx="12" cy="7" r="4"/>
                                    </svg>
                                    Profile Settings
                                </button>
                                
                                <button class="user-menu-item" onclick="openUsersModal()">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                                        <circle cx="9" cy="7" r="4"/>
                                        <path d="M23 21v-2a4 4 0 0 0-3-3.87"/>
                                        <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
                                    </svg>
                                    User Management
                                </button>
                                
                                <button class="user-menu-item" onclick="openSecretKeysModal()">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
                                        <circle cx="12" cy="16" r="1"/>
                                        <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
                                    </svg>
                                    Secret Keys
                                </button>
                            </div>
                            
                            <div class="user-menu-divider"></div>
                            
                            <div class="user-menu-items">
                                <button class="user-menu-item danger" onclick="logout()">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
                                        <polyline points="16,17 21,12 16,7"/>
                                        <line x1="21" y1="12" x2="9" y2="12"/>
                                    </svg>
                                    Sign Out
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content Area -->
        <main class="app-main">
            <!-- Section: Applications -->
            <section id="applications-section" class="content-section">
                <div class="section-header">
                    <div class="section-title-group">
                        <h2 class="section-title">
                            <span class="section-icon">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                    <rect x="3" y="3" width="7" height="7" rx="1"/>
                                    <rect x="14" y="3" width="7" height="7" rx="1"/>
                                    <rect x="3" y="14" width="7" height="7" rx="1"/>
                                    <rect x="14" y="14" width="7" height="7" rx="1"/>
                                </svg>
                            </span>
                            Applications
                        </h2>
                        <p class="section-description">Manage your feature toggle applications and their configurations</p>
                    </div>
                    
                    <div class="section-actions">
                        <button id="new-app-btn" class="btn btn-primary">
                            <span class="btn-icon">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                    <path d="M8 2a.5.5 0 01.5.5v5h5a.5.5 0 010 1h-5v5a.5.5 0 01-1 0v-5h-5a.5.5 0 010-1h5v-5A.5.5 0 018 2z"/>
                                </svg>
                            </span>
                            <span class="btn-text">New Application</span>
                        </button>
                    </div>
                </div>
                
                <div id="applications-list" class="cards-grid">
                    <!-- Applications will be loaded here -->
                </div>
            </section>

            <!-- Section: Toggles (initially hidden) -->
            <section id="toggles-section" class="content-section hidden">
                <div class="section-header">
                    <div class="section-title-group">
                        <div class="section-navigation">
                            <button id="back-to-apps" class="btn btn-ghost">
                                <span class="btn-icon">
                                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                        <path d="M11.354 1.646a.5.5 0 010 .708L5.707 8l5.647 5.646a.5.5 0 01-.708.708l-6-6a.5.5 0 010-.708l6-6a.5.5 0 01.708 0z"/>
                                    </svg>
                                </span>
                                <span class="btn-text">Back to Applications</span>
                            </button>
                        </div>
                        <h2 class="section-title">
                            <span class="section-icon">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M12 2L2 12l10 10 10-10-10-10z"/>
                                    <path d="M12 6L6 12l6 6 6-6-6-6z"/>
                                </svg>
                            </span>
                            <span id="app-name">Application Toggles</span>
                        </h2>
                        <p class="section-description">Configure feature toggles and activation rules for this application</p>
                    </div>
                    
                    <div class="section-actions">
                        <button id="new-toggle-btn" class="btn btn-primary">
                            <span class="btn-icon">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                    <path d="M8 2a.5.5 0 01.5.5v5h5a.5.5 0 010 1h-5v5a.5.5 0 01-1 0v-5h-5a.5.5 0 010-1h5v-5A.5.5 0 018 2z"/>
                                </svg>
                            </span>
                            <span class="btn-text">New Toggle</span>
                        </button>
                    </div>
                </div>
                
                <div id="toggles-list" class="cards-grid">
                    <!-- Toggles will be loaded here -->
                </div>
            </section>
        </main>

        <!-- Footer -->
        <footer class="app-footer">
            <div class="footer-content">
                <p class="footer-text">
                    Licensed under the Apache License 2.0. 
                    <a href="https://github.com/manorfm/totoogle/blob/master/LICENSE" target="_blank" class="footer-link">
                        View License
                    </a>
                </p>
            </div>
        </footer>
    </div>

    <!-- Modal for creating/editing application -->
    <div id="app-modal" class="modal-overlay hidden">
        <div class="modal-container">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="modal-title-section">
                        <div class="modal-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <rect x="3" y="3" width="7" height="7" rx="1"/>
                                <rect x="14" y="3" width="7" height="7" rx="1"/>
                                <rect x="3" y="14" width="7" height="7" rx="1"/>
                                <rect x="14" y="14" width="7" height="7" rx="1"/>
                            </svg>
                        </div>
                        <div>
                            <h3 id="app-modal-title" class="modal-title">New Application</h3>
                            <p class="modal-subtitle">Create a new application to manage feature toggles</p>
                        </div>
                    </div>
                    <button class="modal-close-btn" onclick="closeModal('app-modal')" aria-label="Close">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"/>
                        </svg>
                    </button>
                </div>
                
                <div class="modal-body">
                    <form id="app-form" class="toggle-form">
                        <!-- Application Information Section -->
                        <div class="form-section">
                            <div class="section-header">
                                <h4 class="section-title">Application Information</h4>
                            </div>
                            <div class="form-field">
                                <label class="field-label" for="app-name-input">
                                    Application Name
                                    <span class="field-description">A unique name to identify your application</span>
                                </label>
                                <div class="input-group">
                                    <span class="input-icon">
                                        <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                            <path d="M1.75 2A1.75 1.75 0 000 3.75v8.5C0 13.216.784 14 1.75 14h12.5A1.75 1.75 0 0016 12.25v-8.5A1.75 1.75 0 0014.25 2H1.75zM1.5 3.75a.25.25 0 01.25-.25h12.5a.25.25 0 01.25.25v8.5a.25.25 0 01-.25.25H1.75a.25.25 0 01-.25-.25v-8.5z"/>
                                        </svg>
                                    </span>
                                    <input type="text" id="app-name-input" class="form-input" placeholder="e.g. My Web Application" required>
                                </div>
                                <div class="field-hint">
                                    <span class="hint-icon">üí°</span>
                                    <span class="hint-text">Use a descriptive name that makes it easy to identify this application</span>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>

                <div class="modal-footer">
                    <div class="footer-actions">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('app-modal')">
                            <span class="btn-text">Cancel</span>
                        </button>
                        <button type="submit" form="app-form" class="btn btn-primary">
                            <span class="btn-icon">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                    <path d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"/>
                                </svg>
                            </span>
                            <span class="btn-text">Create Application</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for creating/editing toggle -->
    <div id="toggle-modal" class="modal-overlay hidden">
        <div class="modal-container">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="modal-title-section">
                        <div class="modal-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M12 2L2 12l10 10 10-10-10-10z"/>
                                <path d="M12 6L6 12l6 6 6-6-6-6z"/>
                            </svg>
                        </div>
                        <div>
                            <h3 id="toggle-modal-title" class="modal-title">New Toggle</h3>
                            <p class="modal-subtitle">Create a new feature toggle for this application</p>
                        </div>
                    </div>
                    <button class="modal-close-btn" onclick="closeModal('toggle-modal')" aria-label="Close">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"/>
                        </svg>
                    </button>
                </div>
                
                <div class="modal-body">
                    <form id="toggle-form" class="toggle-form">
                        <!-- Toggle Information Section -->
                        <div class="form-section">
                            <div class="section-header">
                                <h4 class="section-title">Toggle Information</h4>
                            </div>
                            <div class="form-field">
                                <label class="field-label" for="toggle-path-input">
                                    Toggle Path
                                    <span class="field-description">A unique path identifier for this feature toggle</span>
                                </label>
                                <div class="input-group">
                                    <span class="input-icon">
                                        <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                            <path d="M1.75 2A1.75 1.75 0 000 3.75v8.5C0 13.216.784 14 1.75 14h12.5A1.75 1.75 0 0016 12.25v-8.5A1.75 1.75 0 0014.25 2H1.75zM1.5 3.75a.25.25 0 01.25-.25h12.5a.25.25 0 01.25.25v8.5a.25.25 0 01-.25.25H1.75a.25.25 0 01-.25-.25v-8.5z"/>
                                        </svg>
                                    </span>
                                    <input type="text" id="toggle-path-input" class="form-input" placeholder="e.g. feature/new-ui" required>
                                </div>
                                <div class="field-hint">
                                    <span class="hint-icon">üí°</span>
                                    <span class="hint-text">Use a descriptive path like "feature/new-ui" or "experiment/checkout-flow"</span>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>

                <div class="modal-footer">
                    <div class="footer-actions">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('toggle-modal')">
                            <span class="btn-text">Cancel</span>
                        </button>
                        <button type="submit" form="toggle-form" class="btn btn-primary">
                            <span class="btn-icon">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                    <path d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"/>
                                </svg>
                            </span>
                            <span class="btn-text">Create Toggle</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for editing toggle -->
    <div id="edit-toggle-modal" class="modal-overlay hidden">
        <div class="modal-container">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="modal-title-section">
                        <div class="modal-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M12 2L2 12l10 10 10-10-10-10z"/>
                                <path d="M12 6L6 12l6 6 6-6-6-6z"/>
                            </svg>
                        </div>
                        <div>
                            <h3 id="edit-toggle-title" class="modal-title">Edit Toggle Configuration</h3>
                            <p class="modal-subtitle">Configure toggle settings and activation rules</p>
                        </div>
                    </div>
                    <button class="modal-close-btn" onclick="closeModal('edit-toggle-modal')" aria-label="Close">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"/>
                        </svg>
                    </button>
                </div>
                
                <div class="modal-body">
                    <form id="edit-toggle-form" class="toggle-form">
                        <!-- Toggle Path Section -->
                        <div class="form-section">
                            <div class="section-header">
                                <h4 class="section-title">Basic Information</h4>
                            </div>
                            <div class="form-field">
                                <label class="field-label" for="edit-toggle-path-input">
                                    Toggle Path
                                    <span class="field-description">The unique identifier path for this toggle</span>
                                </label>
                                <div class="input-group">
                                    <span class="input-icon">
                                        <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                            <path d="M1.75 2A1.75 1.75 0 000 3.75v8.5C0 13.216.784 14 1.75 14h12.5A1.75 1.75 0 0016 12.25v-8.5A1.75 1.75 0 0014.25 2H1.75zM1.5 3.75a.25.25 0 01.25-.25h12.5a.25.25 0 01.25.25v8.5a.25.25 0 01-.25.25H1.75a.25.25 0 01-.25-.25v-8.5z"/>
                                        </svg>
                                    </span>
                                    <input type="text" id="edit-toggle-path-input" class="form-input" disabled readonly>
                                </div>
                            </div>
                        </div>

                        <!-- Toggle Status Section -->
                        <div class="form-section">
                            <div class="section-header">
                                <h4 class="section-title">Status Configuration</h4>
                            </div>
                            <div class="form-field">
                                <div class="toggle-switch-container">
                                    <label class="toggle-switch" for="edit-toggle-enabled-input">
                                        <input type="checkbox" id="edit-toggle-enabled-input" class="toggle-input">
                                        <span class="toggle-slider"></span>
                                    </label>
                                    <div class="toggle-label-content">
                                        <span class="toggle-label-title">Enable Toggle</span>
                                        <span class="toggle-label-description">When enabled, this toggle will be active and available for use</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Activation Rules Section -->
                        <div class="form-section">
                            <div class="section-header">
                                <h4 class="section-title">Activation Rules</h4>
                                <span class="section-badge">Advanced</span>
                            </div>
                            <div class="form-field">
                                <div class="toggle-switch-container">
                                    <label class="toggle-switch" for="edit-toggle-activation-rule-input">
                                        <input type="checkbox" id="edit-toggle-activation-rule-input" class="toggle-input">
                                        <span class="toggle-slider"></span>
                                    </label>
                                    <div class="toggle-label-content">
                                        <span class="toggle-label-title">Enable Conditional Activation</span>
                                        <span class="toggle-label-description">Apply conditional logic to control when this toggle is active</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div id="activation-rule-config" class="rule-config-panel hidden">
                                <div class="rule-config-content">
                                    <div class="form-field">
                                        <label class="field-label" for="activation-rule-type">
                                            Rule Type
                                            <span class="field-description">Select the type of activation condition</span>
                                        </label>
                                        <div class="select-wrapper">
                                            <select id="activation-rule-type" class="form-select">
                                                <option value="">Choose activation rule type...</option>
                                                <optgroup label="Traffic Control">
                                                    <option value="percentage">üéØ Percentage - Activate for X% of requests</option>
                                                    <option value="canary">üöÄ Canary - Activate for canary releases</option>
                                                </optgroup>
                                                <optgroup label="User Targeting">
                                                    <option value="parameter">‚öôÔ∏è Parameter - Activate based on specific parameter</option>
                                                    <option value="user_id">üë§ User ID - Activate for specific users</option>
                                                </optgroup>
                                                <optgroup label="Environmental">
                                                    <option value="ip">üåê IP Address - Activate for specific IPs</option>
                                                    <option value="country">üåç Country - Activate for specific countries</option>
                                                    <option value="time">‚è∞ Time - Activate at specific times</option>
                                                </optgroup>
                                            </select>
                                            <span class="select-icon">
                                                <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                                    <path d="M4.22 6.22a.75.75 0 011.06 0L8 8.94l2.72-2.72a.75.75 0 111.06 1.06l-3.25 3.25a.75.75 0 01-1.06 0L4.22 7.28a.75.75 0 010-1.06z"/>
                                                </svg>
                                            </span>
                                        </div>
                                    </div>
                                    
                                    <div class="form-field">
                                        <label class="field-label" for="activation-rule-value">
                                            Rule Value
                                            <span class="field-description" id="rule-value-description">Enter the value for your selected rule type</span>
                                        </label>
                                        <div class="input-group">
                                            <span class="input-icon" id="rule-value-icon">
                                                <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                                    <path d="M8 2a.75.75 0 01.75.75v5.69l3.72-3.72a.75.75 0 111.06 1.06L8.75 10.56v2.69a.75.75 0 01-1.5 0v-2.69L2.47 5.78a.75.75 0 011.06-1.06L7.25 8.44V2.75A.75.75 0 018 2z"/>
                                                </svg>
                                            </span>
                                            <input type="text" id="activation-rule-value" class="form-input" placeholder="Enter rule value...">
                                        </div>
                                        <div class="field-hint" id="rule-value-hint">
                                            <span class="hint-icon">üí°</span>
                                            <span class="hint-text">Select a rule type above to see value examples</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>

                <div class="modal-footer">
                    <div class="footer-actions">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('edit-toggle-modal')">
                            <span class="btn-text">Cancel</span>
                        </button>
                        <button type="submit" form="edit-toggle-form" class="btn btn-primary">
                            <span class="btn-icon">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                    <path d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"/>
                                </svg>
                            </span>
                            <span class="btn-text">Save Changes</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for managing secret keys -->
    <div id="secret-key-modal" class="modal-overlay hidden">
        <div class="modal-container">
            <div class="modal-content secret-key-modal">
                <div class="modal-header">
                    <div class="modal-title-section">
                        <div class="modal-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
                                <circle cx="12" cy="16" r="1"/>
                                <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
                            </svg>
                        </div>
                        <div>
                            <h3 id="secret-key-modal-title" class="modal-title">Secret Key</h3>
                            <p class="modal-subtitle">Manage API access for this application</p>
                        </div>
                    </div>
                    <button class="modal-close-btn" onclick="closeModal('secret-key-modal')" aria-label="Close">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"/>
                        </svg>
                    </button>
                </div>
                
                <div class="modal-body">
                    <!-- Generate Secret Key Section -->
                    <div id="secret-key-generate-section" class="form-section" style="display: none;">
                        <div class="section-header">
                            <h4 class="section-title">Generate Secret Key</h4>
                        </div>
                        <div class="alert alert-info">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                <path d="M8 16A8 8 0 1 1 8 0a8 8 0 0 1 0 16zm.93-9.412-1 4.705c-.07.34.029.533.304.533.194 0 .487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703 0-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381 2.29-.287zM8 5.5a1 1 0 1 1 0-2 1 1 0 0 1 0 2z"/>
                            </svg>
                            <div>
                                <p><strong>No secret key found.</strong></p>
                                <p>Generate a secret key to allow API access to this application's toggles. The key will be shown only once.</p>
                            </div>
                        </div>
                    </div>

                    <!-- Display Secret Key Section -->
                    <div id="secret-key-display-section" class="form-section" style="display: none;">
                        <div class="section-header">
                            <h4 class="section-title">Your Secret Key</h4>
                        </div>
                        <div class="alert alert-warning">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                <path d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/>
                            </svg>
                            <div>
                                <p><strong>Important:</strong> This key will only be shown once. Save it securely.</p>
                            </div>
                        </div>
                        <div class="secret-key-display">
                            <label class="field-label">Secret Key</label>
                            <div class="secret-key-value-container">
                                <code id="secret-key-value" class="secret-key-value"></code>
                                <button type="button" class="btn btn-secondary btn-sm" onclick="copySecretKey()">
                                    <svg width="14" height="14" viewBox="0 0 16 16" fill="currentColor">
                                        <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 010 1.5h-1.5a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-1.5a.75.75 0 011.5 0v1.5A1.75 1.75 0 019.25 16h-7.5A1.75 1.75 0 010 14.25v-7.5z"/>
                                        <path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0114.25 11h-7.5A1.75 1.75 0 015 9.25v-7.5zm1.75-.25a.25.25 0 00-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 00.25-.25v-7.5a.25.25 0 00-.25-.25h-7.5z"/>
                                    </svg>
                                    Copy
                                </button>
                            </div>
                        </div>
                        <div class="secret-key-usage">
                            <h5>Usage:</h5>
                            <p>Use this key to access your application's toggles via API:</p>
                            <code>GET /api/toggles/by-secret/{your-secret-key}</code>
                        </div>
                    </div>

                    <!-- Existing Secret Key Section -->
                    <div id="secret-key-existing-section" class="form-section" style="display: none;">
                        <div class="section-header">
                            <h4 class="section-title">Current Secret Key</h4>
                        </div>
                        <div id="secret-key-info"></div>
                        <div class="alert alert-warning">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                <path d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"/>
                            </svg>
                            <div>
                                <p><strong>Warning:</strong> Regenerating will invalidate the current key and break existing integrations.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="modal-footer">
                    <div class="footer-actions">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('secret-key-modal')">
                            <span class="btn-text">Close</span>
                        </button>
                        
                        <!-- Generate button (shown when no key exists) -->
                        <button type="button" class="btn btn-primary" onclick="generateSecretKey()" id="generate-secret-btn" style="display: none;">
                            <span class="btn-icon">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                    <path d="M8 2a.5.5 0 0 1 .5.5v5h5a.5.5 0 0 1 0 1h-5v5a.5.5 0 0 1-1 0v-5h-5a.5.5 0 0 1 0-1h5v-5A.5.5 0 0 1 8 2z"/>
                                </svg>
                            </span>
                            <span class="btn-text">Generate Secret Key</span>
                        </button>
                        
                        <!-- Regenerate button (shown when key exists) -->
                        <button type="button" class="btn btn-danger" onclick="regenerateSecretKey()" id="regenerate-secret-btn" style="display: none;">
                            <span class="btn-icon">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                    <path d="M11.534 7h3.932a.25.25 0 0 1 .192.41l-1.966 2.36a.25.25 0 0 1-.384 0l-1.966-2.36a.25.25 0 0 1 .192-.41zm-11 2h3.932a.25.25 0 0 0 .192-.41L2.692 6.23a.25.25 0 0 0-.384 0L.342 8.59A.25.25 0 0 0 .534 9z"/>
                                    <path fill-rule="evenodd" d="M8 3c-1.552 0-2.94.707-3.857 1.818a.5.5 0 1 1-.771-.636A6.002 6.002 0 0 1 13.917 7H12.9A5.002 5.002 0 0 0 8 3zM3.1 9a5.002 5.002 0 0 0 8.757 2.182.5.5 0 1 1 .771.636A6.002 6.002 0 0 1 2.083 9H3.1z"/>
                                </svg>
                            </span>
                            <span class="btn-text">Regenerate Key</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="toast-container"></div>

    <!-- Global Loading Spinner -->
    <div id="global-loading-spinner" class="global-spinner-overlay hidden">
        <div class="spinner"></div>
    </div>

    <script src="/static/script.js"></script>
</body>
</html> 