<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ToToogle - Feature Toggle Manager</title>
    <link rel="stylesheet" href="/static/styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Page Transition Overlay -->
    <div id="page-transition-overlay" class="page-transition-overlay">
        <div class="page-transition-content">
            <div class="page-transition-spinner"></div>
            <div class="page-transition-text">Loading ToToogle</div>
            <div class="page-transition-subtext">Preparing your feature toggles...</div>
        </div>
    </div>

    <!-- Main Layout Container -->
    <div class="app-layout">
        <!-- Header/Navigation -->
        <header class="app-header">
            <div class="header-content">
                <div class="brand-section">
                    <div class="brand-icon">
                        <svg width="32" height="32" viewBox="0 0 32 32" fill="currentColor">
                            <path d="M4 8h6v2H4V8zm0 4h6v2H4v-2zm0 4h6v2H4v-2zm8-8h16v2H12V8zm0 4h16v2H12v-2zm0 4h16v2H12v-2z"/>
                            <rect x="6" y="18" width="20" height="10" rx="2" fill="none" stroke="currentColor" stroke-width="2"/>
                            <circle cx="23" cy="23" r="2" fill="currentColor"/>
                        </svg>
                    </div>
                    <div class="brand-text">
                        <h1 class="brand-title">ToToogle</h1>
                        <p class="brand-subtitle">Feature Toggle Manager</p>
                    </div>
                </div>
                
                <div class="header-actions">
                    <!-- User Profile Menu -->
                    <div class="user-menu" id="user-menu">
                        <button class="user-menu-trigger" id="user-menu-trigger">
                            <div class="user-avatar" id="user-avatar">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                                    <circle cx="12" cy="7" r="4"/>
                                </svg>
                            </div>
                            <span class="user-name" id="user-name">Admin</span>
                            <svg class="user-menu-chevron" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="6,9 12,15 18,9"/>
                            </svg>
                        </button>
                        
                        <div class="user-menu-dropdown hidden" id="user-menu-dropdown">
                            <div class="user-menu-header">
                                <div class="user-menu-avatar">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                                        <circle cx="12" cy="7" r="4"/>
                                    </svg>
                                </div>
                                <div class="user-menu-info">
                                    <div class="user-menu-name" id="dropdown-user-name">Admin</div>
                                    <div class="user-menu-role" id="dropdown-user-role">Administrator</div>
                                </div>
                            </div>
                            
                            <div class="user-menu-divider"></div>
                            
                            <div class="user-menu-items">
                                <button class="user-menu-item" onclick="openProfileModal()">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                                        <circle cx="12" cy="7" r="4"/>
                                    </svg>
                                    Profile Settings
                                </button>
                                
                                <button id="user-management-btn" class="user-menu-item" onclick="openUsersModal()">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                                        <circle cx="9" cy="7" r="4"/>
                                        <path d="M23 21v-2a4 4 0 0 0-3-3.87"/>
                                        <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
                                    </svg>
                                    User Management
                                </button>
                            </div>
                            
                            <div class="user-menu-divider"></div>
                            
                            <div class="user-menu-items">
                                <button class="user-menu-item danger" onclick="logout()">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
                                        <polyline points="16,17 21,12 16,7"/>
                                        <line x1="21" y1="12" x2="9" y2="12"/>
                                    </svg>
                                    Sign Out
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content Area -->
        <main class="app-main">
            <!-- Section: Applications -->
            <section id="applications-section" class="content-section">
                <div class="section-header">
                    <div class="section-title-group">
                        <h2 class="section-title">
                            <span class="section-icon">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                    <rect x="3" y="3" width="7" height="7" rx="1"/>
                                    <rect x="14" y="3" width="7" height="7" rx="1"/>
                                    <rect x="3" y="14" width="7" height="7" rx="1"/>
                                    <rect x="14" y="14" width="7" height="7" rx="1"/>
                                </svg>
                            </span>
                            Applications
                        </h2>
                        <p class="section-description">Manage your feature toggle applications and their configurations</p>
                    </div>
                    
                    <div class="section-actions">
                        <button id="new-app-btn" class="btn btn-primary">
                            <span class="btn-icon">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                    <path d="M8 2a.5.5 0 01.5.5v5h5a.5.5 0 010 1h-5v5a.5.5 0 01-1 0v-5h-5a.5.5 0 010-1h5v-5A.5.5 0 018 2z"/>
                                </svg>
                            </span>
                            <span class="btn-text">New Application</span>
                        </button>
                    </div>
                </div>
                
                <div id="applications-list" class="cards-grid">
                    <!-- Applications will be loaded here -->
                </div>
            </section>

            <!-- Section: Toggles (initially hidden) -->
            <section id="toggles-section" class="content-section hidden">
                <div class="section-header">
                    <div class="section-title-group">
                        <div class="section-navigation">
                            <button id="back-to-apps" class="btn btn-ghost">
                                <span class="btn-icon">
                                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                        <path d="M11.354 1.646a.5.5 0 010 .708L5.707 8l5.647 5.646a.5.5 0 01-.708.708l-6-6a.5.5 0 010-.708l6-6a.5.5 0 01.708 0z"/>
                                    </svg>
                                </span>
                                <span class="btn-text">Back to Applications</span>
                            </button>
                        </div>
                        <h2 class="section-title">
                            <span class="section-icon">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M12 2L2 12l10 10 10-10-10-10z"/>
                                    <path d="M12 6L6 12l6 6 6-6-6-6z"/>
                                </svg>
                            </span>
                            <span id="app-name">Application Toggles</span>
                        </h2>
                        <p class="section-description">Configure feature toggles and activation rules for this application</p>
                    </div>
                    
                    <div class="section-actions">
                        <button id="new-toggle-btn" class="btn btn-primary">
                            <span class="btn-icon">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                    <path d="M8 2a.5.5 0 01.5.5v5h5a.5.5 0 010 1h-5v5a.5.5 0 01-1 0v-5h-5a.5.5 0 010-1h5v-5A.5.5 0 018 2z"/>
                                </svg>
                            </span>
                            <span class="btn-text">New Toggle</span>
                        </button>
                    </div>
                </div>
                
                <div id="toggles-list" class="cards-grid">
                    <!-- Toggles will be loaded here -->
                </div>
            </section>
        </main>

        <!-- Footer -->
        <footer class="app-footer">
            <div class="footer-content">
                <p class="footer-text">
                    Licensed under the Apache License 2.0. 
                    <a href="https://github.com/manorfm/totoogle/blob/master/LICENSE" target="_blank" class="footer-link">
                        View License
                    </a>
                </p>
            </div>
        </footer>
    </div>

    <!-- Modal for creating/editing application -->
    <div id="app-modal" class="modal-overlay hidden">
        <div class="modal-container">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="modal-title-section">
                        <div class="modal-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <rect x="3" y="3" width="7" height="7" rx="1"/>
                                <rect x="14" y="3" width="7" height="7" rx="1"/>
                                <rect x="3" y="14" width="7" height="7" rx="1"/>
                                <rect x="14" y="14" width="7" height="7" rx="1"/>
                            </svg>
                        </div>
                        <div>
                            <h3 id="app-modal-title" class="modal-title">New Application</h3>
                            <p class="modal-subtitle">Create a new application to manage feature toggles</p>
                        </div>
                    </div>
                    <button class="modal-close-btn" onclick="closeModal('app-modal')" aria-label="Close">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"/>
                        </svg>
                    </button>
                </div>
                
                <div class="modal-body">
                    <form id="app-form" class="toggle-form">
                        <!-- Application Information Section -->
                        <div class="form-section">
                            <div class="section-header">
                                <h4 class="section-title">Application Information</h4>
                            </div>
                            <div class="form-field">
                                <label class="field-label" for="app-name-input">
                                    Application Name
                                    <span class="field-description">A unique name to identify your application</span>
                                </label>
                                <div class="input-group">
                                    <span class="input-icon">
                                        <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                            <path d="M1.75 2A1.75 1.75 0 000 3.75v8.5C0 13.216.784 14 1.75 14h12.5A1.75 1.75 0 0016 12.25v-8.5A1.75 1.75 0 0014.25 2H1.75zM1.5 3.75a.25.25 0 01.25-.25h12.5a.25.25 0 01.25.25v8.5a.25.25 0 01-.25.25H1.75a.25.25 0 01-.25-.25v-8.5z"/>
                                        </svg>
                                    </span>
                                    <input type="text" id="app-name-input" class="form-input" placeholder="e.g. My Web Application" required>
                                </div>
                                <div class="field-hint">
                                    <span class="hint-icon">💡</span>
                                    <span class="hint-text">Use a descriptive name that makes it easy to identify this application</span>
                                </div>
                            </div>
                            
                            <div class="form-field">
                                <label class="field-label" for="app-team-select">
                                    Team Assignment
                                    <span class="field-description">Select which team will manage this application</span>
                                </label>
                                <div class="input-group">
                                    <span class="input-icon">
                                        <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                            <path d="M5.5 3.5a2 2 0 11-4 0 2 2 0 014 0zM2.5 6.5a3 3 0 013 3v1.5c0 .83-.67 1.5-1.5 1.5H1.5C.67 12.5 0 11.83 0 11v-1.5a3 3 0 013-3h2zm6.5-3a2 2 0 11-4 0 2 2 0 014 0zM9 6.5a3 3 0 013 3v1.5c0 .83-.67 1.5-1.5 1.5h-2.5c-.83 0-1.5-.67-1.5-1.5V9.5a3 3 0 013-3h1zm6.5-3a2 2 0 11-4 0 2 2 0 014 0zm-1.5 3a3 3 0 013 3v1.5c0 .83-.67 1.5-1.5 1.5h-2.5c-.83 0-1.5-.67-1.5-1.5V9.5a3 3 0 013-3h1z"/>
                                        </svg>
                                    </span>
                                    <select id="app-team-select" class="form-select" required>
                                        <option value="">Select a team...</option>
                                        <!-- Teams will be loaded dynamically -->
                                    </select>
                                </div>
                                <div class="field-hint">
                                    <span class="hint-icon">👥</span>
                                    <span class="hint-text">Only members of the selected team will have access to manage this application</span>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>

                <div class="modal-footer">
                    <div class="footer-actions">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('app-modal')">
                            <span class="btn-text">Cancel</span>
                        </button>
                        <button type="submit" form="app-form" class="btn btn-primary">
                            <span class="btn-icon">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                    <path d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"/>
                                </svg>
                            </span>
                            <span class="btn-text">Create Application</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for creating/editing toggle -->
    <div id="toggle-modal" class="modal-overlay hidden">
        <div class="modal-container">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="modal-title-section">
                        <div class="modal-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M12 2L2 12l10 10 10-10-10-10z"/>
                                <path d="M12 6L6 12l6 6 6-6-6-6z"/>
                            </svg>
                        </div>
                        <div>
                            <h3 id="toggle-modal-title" class="modal-title">New Toggle</h3>
                            <p class="modal-subtitle">Create a new feature toggle for this application</p>
                        </div>
                    </div>
                    <button class="modal-close-btn" onclick="closeModal('toggle-modal')" aria-label="Close">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"/>
                        </svg>
                    </button>
                </div>
                
                <div class="modal-body">
                    <form id="toggle-form" class="toggle-form">
                        <!-- Toggle Information Section -->
                        <div class="form-section">
                            <div class="section-header">
                                <h4 class="section-title">Toggle Information</h4>
                            </div>
                            <div class="form-field">
                                <label class="field-label" for="toggle-path-input">
                                    Toggle Path
                                    <span class="field-description">A unique path identifier for this feature toggle</span>
                                </label>
                                <div class="input-group">
                                    <span class="input-icon">
                                        <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                            <path d="M1.75 2A1.75 1.75 0 000 3.75v8.5C0 13.216.784 14 1.75 14h12.5A1.75 1.75 0 0016 12.25v-8.5A1.75 1.75 0 0014.25 2H1.75zM1.5 3.75a.25.25 0 01.25-.25h12.5a.25.25 0 01.25.25v8.5a.25.25 0 01-.25.25H1.75a.25.25 0 01-.25-.25v-8.5z"/>
                                        </svg>
                                    </span>
                                    <input type="text" id="toggle-path-input" class="form-input" placeholder="e.g. feature.new-ui" required>
                                </div>
                                <div class="field-hint">
                                    <span class="hint-icon">💡</span>
                                    <span class="hint-text">Use a descriptive path like "feature.new-ui" or "experiment.checkout-flow"</span>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>

                <div class="modal-footer">
                    <div class="footer-actions">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('toggle-modal')">
                            <span class="btn-text">Cancel</span>
                        </button>
                        <button type="submit" form="toggle-form" class="btn btn-primary">
                            <span class="btn-icon">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                    <path d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"/>
                                </svg>
                            </span>
                            <span class="btn-text">Create Toggle</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for editing toggle -->
    <div id="edit-toggle-modal" class="modal-overlay hidden">
        <div class="modal-container">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="modal-title-section">
                        <div class="modal-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M12 2L2 12l10 10 10-10-10-10z"/>
                                <path d="M12 6L6 12l6 6 6-6-6-6z"/>
                            </svg>
                        </div>
                        <div>
                            <h3 id="edit-toggle-title" class="modal-title">Edit Toggle Configuration</h3>
                            <p class="modal-subtitle">Configure toggle settings and activation rules</p>
                        </div>
                    </div>
                    <button class="modal-close-btn" onclick="closeModal('edit-toggle-modal')" aria-label="Close">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"/>
                        </svg>
                    </button>
                </div>
                
                <div class="modal-body">
                    <form id="edit-toggle-form" class="toggle-form">
                        <!-- Toggle Path Section -->
                        <div class="form-section">
                            <div class="section-header">
                                <h4 class="section-title">Basic Information</h4>
                            </div>
                            <div class="form-field">
                                <label class="field-label" for="edit-toggle-path-input">
                                    Toggle Path
                                    <span class="field-description">The unique identifier path for this toggle</span>
                                </label>
                                <div class="input-group">
                                    <span class="input-icon">
                                        <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                            <path d="M1.75 2A1.75 1.75 0 000 3.75v8.5C0 13.216.784 14 1.75 14h12.5A1.75 1.75 0 0016 12.25v-8.5A1.75 1.75 0 0014.25 2H1.75zM1.5 3.75a.25.25 0 01.25-.25h12.5a.25.25 0 01.25.25v8.5a.25.25 0 01-.25.25H1.75a.25.25 0 01-.25-.25v-8.5z"/>
                                        </svg>
                                    </span>
                                    <input type="text" id="edit-toggle-path-input" class="form-input" disabled readonly>
                                </div>
                            </div>
                        </div>

                        <!-- Toggle Status Section -->
                        <div class="form-section">
                            <div class="section-header">
                                <h4 class="section-title">Status Configuration</h4>
                            </div>
                            <div class="form-field">
                                <div class="toggle-switch-container">
                                    <label class="toggle-switch" for="edit-toggle-enabled-input">
                                        <input type="checkbox" id="edit-toggle-enabled-input" class="toggle-input">
                                        <span class="toggle-slider"></span>
                                    </label>
                                    <div class="toggle-label-content">
                                        <span class="toggle-label-title">Enable Toggle</span>
                                        <span class="toggle-label-description">When enabled, this toggle will be active and available for use</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Activation Rules Section -->
                        <div class="form-section">
                            <div class="section-header">
                                <h4 class="section-title">Activation Rules</h4>
                                <span class="section-badge">Advanced</span>
                            </div>
                            <div class="form-field">
                                <div class="toggle-switch-container">
                                    <label class="toggle-switch" for="edit-toggle-activation-rule-input">
                                        <input type="checkbox" id="edit-toggle-activation-rule-input" class="toggle-input">
                                        <span class="toggle-slider"></span>
                                    </label>
                                    <div class="toggle-label-content">
                                        <span class="toggle-label-title">Enable Conditional Activation</span>
                                        <span class="toggle-label-description">Apply conditional logic to control when this toggle is active</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div id="activation-rule-config" class="rule-config-panel hidden">
                                <div class="rule-config-content">
                                    <div class="form-field">
                                        <label class="field-label" for="activation-rule-type">
                                            Rule Type
                                            <span class="field-description">Select the type of activation condition</span>
                                        </label>
                                        <div class="select-wrapper">
                                            <select id="activation-rule-type" class="form-select">
                                                <option value="">Choose activation rule type...</option>
                                                <optgroup label="Traffic Control">
                                                    <option value="percentage">🎯 Percentage - Activate for X% of requests</option>
                                                    <option value="canary">🚀 Canary - Activate for canary releases</option>
                                                </optgroup>
                                                <optgroup label="User Targeting">
                                                    <option value="parameter">⚙️ Parameter - Activate based on specific parameter</option>
                                                    <option value="user_id">👤 User ID - Activate for specific users</option>
                                                </optgroup>
                                                <optgroup label="Environmental">
                                                    <option value="ip">🌐 IP Address - Activate for specific IPs</option>
                                                    <option value="country">🌍 Country - Activate for specific countries</option>
                                                    <option value="time">⏰ Time - Activate at specific times</option>
                                                </optgroup>
                                            </select>
                                            <span class="select-icon">
                                                <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                                    <path d="M4.22 6.22a.75.75 0 011.06 0L8 8.94l2.72-2.72a.75.75 0 111.06 1.06l-3.25 3.25a.75.75 0 01-1.06 0L4.22 7.28a.75.75 0 010-1.06z"/>
                                                </svg>
                                            </span>
                                        </div>
                                    </div>
                                    
                                    <div class="form-field">
                                        <label class="field-label" for="activation-rule-value">
                                            Rule Value
                                            <span class="field-description" id="rule-value-description">Enter the value for your selected rule type</span>
                                        </label>
                                        <div class="input-group">
                                            <span class="input-icon" id="rule-value-icon">
                                                <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                                    <path d="M8 2a.75.75 0 01.75.75v5.69l3.72-3.72a.75.75 0 111.06 1.06L8.75 10.56v2.69a.75.75 0 01-1.5 0v-2.69L2.47 5.78a.75.75 0 011.06-1.06L7.25 8.44V2.75A.75.75 0 018 2z"/>
                                                </svg>
                                            </span>
                                            <input type="text" id="activation-rule-value" class="form-input" placeholder="Enter rule value...">
                                        </div>
                                        <div class="field-hint" id="rule-value-hint">
                                            <span class="hint-icon">💡</span>
                                            <span class="hint-text">Select a rule type above to see value examples</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>

                <div class="modal-footer">
                    <div class="footer-actions">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('edit-toggle-modal')">
                            <span class="btn-text">Cancel</span>
                        </button>
                        <button type="submit" form="edit-toggle-form" class="btn btn-primary">
                            <span class="btn-icon">
                                <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                    <path d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"/>
                                </svg>
                            </span>
                            <span class="btn-text">Save Changes</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for displaying generated secret key -->
    <div id="secret-key-modal" class="modal-overlay hidden">
        <div class="modal-container">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="modal-title-section">
                        <div class="modal-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"/>
                            </svg>
                        </div>
                        <div>
                            <h3 class="modal-title">Secret Key Generated</h3>
                            <p class="modal-subtitle">Save this key securely - it won't be shown again</p>
                        </div>
                    </div>
                    <button class="modal-close-btn" onclick="closeModal('secret-key-modal')" aria-label="Close">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"/>
                        </svg>
                    </button>
                </div>
                
                <div class="modal-body">
                    <div class="form-section">
                        <div class="section-header">
                            <h4 class="section-title">Your Secret Key</h4>
                            <p class="section-description">Use this key to access toggles via API</p>
                        </div>
                        <div class="form-field">
                            <label class="field-label">
                                Secret Key
                                <span class="field-description">Copy and store this key safely</span>
                            </label>
                            <div class="input-group">
                                <span class="input-icon">
                                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                        <path d="M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"/>
                                    </svg>
                                </span>
                                <input type="text" id="secret-key-display" class="form-input" readonly onclick="this.select()">
                                <button type="button" class="btn btn-secondary" id="copy-secret-btn">
                                    <span class="btn-icon">
                                        <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                            <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/>
                                            <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/>
                                        </svg>
                                    </span>
                                    <span class="btn-text">Copy</span>
                                </button>
                            </div>
                            <div class="field-hint">
                                <span class="hint-icon">⚠️</span>
                                <span class="hint-text">Store this key safely. It will not be displayed again for security reasons.</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="modal-footer">
                    <div class="footer-actions">
                        <button type="button" class="btn btn-primary" onclick="closeModal('secret-key-modal')">
                            <span class="btn-text">Got it</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for editing user -->
    <div id="edit-user-modal" class="modal-overlay hidden">
        <div class="modal-container">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="modal-title-section">
                        <div class="modal-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z"/>
                            </svg>
                        </div>
                        <div>
                            <h3 class="modal-title" id="edit-user-modal-title">Edit User</h3>
                            <p class="modal-subtitle" id="edit-user-modal-subtitle">Configure user permissions and team access</p>
                        </div>
                    </div>
                    <button class="modal-close-btn" onclick="closeModal('edit-user-modal')" aria-label="Close">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"/>
                        </svg>
                    </button>
                </div>
                
                <div class="modal-body">
                    <!-- User Role Section -->
                    <div class="form-section">
                        <div class="section-header">
                            <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor" class="section-icon">
                                <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                            </svg>
                            <div>
                                <h4 class="section-title">Access Level</h4>
                                <p class="section-description">Set user permissions and role</p>
                            </div>
                        </div>
                        <div class="form-field">
                            <div class="input-group">
                                <span class="input-icon">
                                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                        <path d="M1 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H1zm5-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
                                    </svg>
                                </span>
                                <select id="edit-user-role" class="form-select" required>
                                    <option value="">Select role...</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Team Access Section -->
                    <div class="form-section">
                        <div class="section-header">
                            <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor" class="section-icon">
                                <path d="M9 12l2 2 4-4m5.25-1.25a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0zm-9-3.25a3.5 3.5 0 100 7 3.5 3.5 0 000-7z"/>
                            </svg>
                            <div>
                                <h4 class="section-title">Team Access</h4>
                                <p class="section-description">Manage team memberships</p>
                            </div>
                        </div>
                        
                        <!-- Search Input -->
                        <div class="form-field">
                            <div class="input-group">
                                <span class="input-icon">
                                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                        <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
                                    </svg>
                                </span>
                                <input type="text" id="team-search-input" class="form-input" placeholder="Search teams..." autocomplete="off">
                            </div>
                        </div>
                        
                        <!-- Teams List -->
                        <div class="teams-container" id="edit-user-teams">
                            <!-- Teams will be populated here -->
                        </div>
                        
                        <div class="empty-state hidden" id="teams-empty-state">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                                <circle cx="9" cy="7" r="4"/>
                                <path d="M23 21v-2a4 4 0 0 0-3-3.87"/>
                                <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
                            </svg>
                            <p>No teams found matching your search</p>
                        </div>
                    </div>
                </div>

                <div class="modal-footer">
                    <div class="footer-actions">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('edit-user-modal')">
                            Cancel
                        </button>
                        <button type="button" class="btn btn-primary" id="save-user-changes-btn">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                <path d="M13.78 4.22a.75.75 0 010 1.06l-7.25 7.25a.75.75 0 01-1.06 0L2.22 9.28a.75.75 0 011.06-1.06L6 10.94l6.72-6.72a.75.75 0 011.06 0z"/>
                            </svg>
                            Save Changes
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <!-- Profile Modal -->
    <div id="profile-modal" class="modal-overlay hidden">
        <div class="modal-container">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="modal-title-section">
                        <div class="modal-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                                <circle cx="12" cy="7" r="4"/>
                            </svg>
                        </div>
                        <div>
                            <h3 class="modal-title">Profile Settings</h3>
                            <p class="modal-subtitle">Manage your account information and settings</p>
                        </div>
                    </div>
                    <button class="modal-close-btn" onclick="closeModal('profile-modal')" aria-label="Close">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"/>
                        </svg>
                    </button>
                </div>
                
                <div class="modal-body">
                    <!-- User Information Section -->
                    <div class="form-section">
                        <div class="section-header">
                            <h4 class="section-title">User Information</h4>
                        </div>
                        
                        <div class="profile-info-card">
                            <div class="profile-avatar-section">
                                <div class="profile-avatar" id="profile-avatar">
                                    <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                                        <circle cx="12" cy="7" r="4"/>
                                    </svg>
                                </div>
                            </div>
                            
                            <div class="profile-info-content">
                                <div class="form-field">
                                    <label class="field-label">Username</label>
                                    <div class="input-group">
                                        <span class="input-icon">
                                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                                                <circle cx="12" cy="7" r="4"/>
                                            </svg>
                                        </span>
                                        <input type="text" id="profile-username" class="form-input" readonly>
                                    </div>
                                </div>
                                
                                <div class="form-field">
                                    <label class="field-label">Role</label>
                                    <div class="input-group">
                                        <span class="input-icon">
                                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                <path d="M9 12l2 2 4-4"/>
                                                <path d="M21 12c0 1.2-.4 2.3-1 3.2a9 9 0 1 1 0-6.4c.6.9 1 2 1 3.2z"/>
                                            </svg>
                                        </span>
                                        <input type="text" id="profile-role" class="form-input" readonly>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Teams Section -->
                    <div class="form-section">
                        <div class="section-header">
                            <h4 class="section-title">Teams</h4>
                            <span class="section-description">Teams you are associated with</span>
                        </div>
                        
                        <div id="profile-teams-list" class="teams-list">
                            <!-- Teams will be loaded here -->
                        </div>
                    </div>

                    <!-- Security Section -->
                    <div class="form-section">
                        <div class="section-header">
                            <h4 class="section-title">Security</h4>
                            <span class="section-description">Manage your account security settings</span>
                        </div>
                        
                        <div class="security-actions">
                            <button type="button" class="btn btn-primary" onclick="openChangePasswordModal()">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
                                    <circle cx="12" cy="16" r="1"/>
                                    <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
                                </svg>
                                <span class="btn-text">Change Password</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Change Password Modal -->
    <div id="change-password-modal" class="modal-overlay hidden">
        <div class="modal-container">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="modal-title-section">
                        <div class="modal-icon">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
                                <circle cx="12" cy="16" r="1"/>
                                <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
                            </svg>
                        </div>
                        <div>
                            <h3 class="modal-title">Change Password</h3>
                            <p class="modal-subtitle">Update your account password</p>
                        </div>
                    </div>
                    <button class="modal-close-btn" onclick="closeModal('change-password-modal')" aria-label="Close">
                        <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"/>
                        </svg>
                    </button>
                </div>
                
                <div class="modal-body">
                    <form id="change-password-form" class="toggle-form">
                        <div class="form-section">
                            <div class="form-field">
                                <label class="field-label" for="current-password-input">
                                    Current Password
                                    <span class="field-description">Enter your current password</span>
                                </label>
                                <div class="input-group">
                                    <span class="input-icon">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
                                            <circle cx="12" cy="16" r="1"/>
                                            <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
                                        </svg>
                                    </span>
                                    <input type="password" id="current-password-input" class="form-input" required>
                                </div>
                            </div>
                            
                            <div class="form-field">
                                <label class="field-label" for="new-password-input">
                                    New Password
                                    <span class="field-description">Enter your new password</span>
                                </label>
                                <div class="input-group">
                                    <span class="input-icon">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
                                            <circle cx="12" cy="16" r="1"/>
                                            <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
                                        </svg>
                                    </span>
                                    <input type="password" id="new-password-input" class="form-input" required>
                                </div>
                            </div>
                            
                            <div class="form-field">
                                <label class="field-label" for="confirm-password-input">
                                    Confirm New Password
                                    <span class="field-description">Confirm your new password</span>
                                </label>
                                <div class="input-group">
                                    <span class="input-icon">
                                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
                                            <circle cx="12" cy="16" r="1"/>
                                            <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
                                        </svg>
                                    </span>
                                    <input type="password" id="confirm-password-input" class="form-input" required>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>

                <div class="modal-footer">
                    <div class="footer-actions">
                        <button type="button" class="btn btn-secondary" onclick="closeModal('change-password-modal')">
                            <span class="btn-text">Cancel</span>
                        </button>
                        <button type="button" class="btn btn-primary" onclick="submitChangePassword()">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
                                <circle cx="12" cy="16" r="1"/>
                                <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
                            </svg>
                            <span class="btn-text">Change Password</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="toast-container"></div>

    <!-- Global Loading Spinner -->
    <div id="global-loading-spinner" class="global-spinner-overlay hidden">
        <div class="spinner"></div>
    </div>

    <script src="/static/script.js"></script>
</body>
</html> 